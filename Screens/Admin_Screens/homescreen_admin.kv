#: import NoTransition kivy.uix.screenmanager.NoTransition
#: import Factory kivy.factory.Factory

<GraphSpinner@Spinner>:
    font_name: "MPoppins"
    font_size: "12sp"
    background_normal: "white"  # Override the default background
    background_down: "white"  # Override the default background when pressed
    background_color: 80/255, 196/255, 242/255, 1
    option_cls: Factory.Sp  

<GraphLabel@Label>:
    font_name: "MPoppins"
    font_size: "16sp"
    size_hint_x: 4
    width: self.texture_size[0] + 20
    canvas.before:
        Color:
            rgba: 24/255, 106/255, 232/255, 1
        Rectangle:
            pos: self.pos
            size: self.size

<GraphSeparator@MDSeparator>
    height: "1dp"
    size_hint_y: None

<Sp@SpinnerOption>:
    font_name: 'MPoppins'
    font_size: "12sp"
    background_normal: "white"
    background_color: 80/255, 196/255, 242/255, 1


<StatsLayout>
    ScrollView:
        size: root.width, root.height
        do_scroll_x: False  # Disable horizontal scrolling
        do_scroll_y: True   # Enable vertical scrolling


        BoxLayout:
            orientation: "vertical"
            size_hint_y: None  # Allow dynamic height
            height: self.minimum_height  # Set height to sum of children
            padding: 20
            spacing: 25


            # First statistics box
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: 300  # Specify the height for the content
                size_hint_x: 1

                BoxLayout:
                    size_hint: (1, .15)
                    GraphSpinner:
                        id: first_spinner_id
                        text: "Menu"
                        values: ["1 Month", "3 Months", "6 Months", "1 Year", "All"]
                        on_text: root.first_spinner(self, self.text)
                    GraphLabel:
                        text: "Medical Emergency"
                        
                Graph:
                    id: first_graph
                    size_hint: (1, .85)
                    xlabel: 'Date'
                    ylabel: 'Incidents'
                    x_ticks_minor: 5
                    x_ticks_major: 10
                    y_ticks_minor: 1
                    y_ticks_major: 5
                    x_grid: True
                    y_grid: True
                    x_grid_label: True
                    y_grid_label: True
                    padding: 5
                    xlog: False
                    ylog: False

            GraphSeparator:

            # Second statistics box
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: 300  # Specify the height for the content
                size_hint_x: 1


                BoxLayout:
                    size_hint: (1, .15)
                    GraphSpinner:
                        id: second_spinner_id
                        text: "Menu"
                        values: ["1 Month", "3 Months", "6 Months", "1 Year", "All"]
                        on_text: root.second_spinner(self, self.text)
                    GraphLabel:
                        text: "Natural Disaster"

                Graph:
                    id: second_graph
                    size_hint: (1, .85)
                    xlabel: 'Date'
                    ylabel: 'Incidents'
                    x_ticks_minor: 5
                    x_ticks_major: 10
                    y_ticks_minor: 1
                    y_ticks_major: 5
                    x_grid: True
                    y_grid: True
                    x_grid_label: True
                    y_grid_label: True
                    padding: 5
                    xlog: False
                    ylog: False

            GraphSeparator:

            # Third statistics box
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: 300  # Specify the height for the content
                size_hint_x: 1

                BoxLayout:
                    size_hint: (1, .15)
                    GraphSpinner:
                        id: third_spinner_id
                        text: "Menu"
                        values: ["1 Month", "3 Months", "6 Months", "1 Year", "All"]
                        on_text: root.third_spinner(self, self.text)
                    GraphLabel:
                        text: "Security Threat"
                        
                Graph:
                    id: third_graph
                    size_hint: (1, .85)
                    xlabel: 'Date'
                    ylabel: 'Incidents'
                    x_ticks_minor: 5
                    x_ticks_major: 10
                    y_ticks_minor: 1
                    y_ticks_major: 5
                    x_grid: True
                    y_grid: True
                    x_grid_label: True
                    y_grid_label: True
                    padding: 5
                    xlog: False
                    ylog: False

            GraphSeparator:

            # Fourth statistics box
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: 300  # Specify the height for the content
                size_hint_x: 1
               
                BoxLayout:
                    size_hint: (1, .15)
                    GraphSpinner:
                        id: last_spinner_id
                        text: "Menu"
                        values: ["1 Month", "3 Months", "6 Months", "1 Year", "All"]
                        on_text: root.last_spinner(self, self.text)
                    GraphLabel:
                        text: "Others"
               
                Graph:
                    id: last_graph
                    size_hint: (1, .85)
                    xlabel: 'Date'
                    ylabel: 'Incidents'
                    x_ticks_minor: 5
                    x_ticks_major: 10
                    y_ticks_minor: 1
                    y_ticks_major: 5
                    x_grid: True
                    y_grid: True
                    x_grid_label: True
                    y_grid_label: True
                    padding: 5
                    xlog: False
                    ylog: False

<TwoPartLabel@BoxLayout>:
    orientation: 'horizontal'
    size_hint_y: None
    padding: 1

    MDLabel:
        id: label_prefix
        font_name: "BPoppins"
        halign: "left"  
        size_hint_y: None
        text: ""
        font_size: "15sp"

    MDLabel:
        id: label_dynamic
        font_name: "MPoppins"
        halign: "center"  
        size_hint_y: None
        text: ""
        font_size: "14sp"
        

<Separator@MDSeparator>:
    height: "1dp"

<DialogContent>:
    orientation: "vertical"
    size_hint_y: None
    height: "400dp"

    BoxLayout:
        size_hint_y: None
        height: self.minimum_height  # Adjust the height to fit the content
        
        MDLabel:
            text: "Report History"
            font_name: "BPoppins"
            font_size: "22sp"
            size_hint_y: None
            height: self.texture_size[1]

    ScrollView:
        size_hint_y: None
        height: 500  # Adjust based on your dialog box size

        GridLayout:
            cols: 1
            size_hint_y: None
            size_hint_x: 1  # Take full width of the ScrollView
            height: self.minimum_height
            spacing: "15dp"
            padding: [0, 20, 30, 30]  # Padding: [left, top, right, bottom]
            pos_hint: {'center_x': 0.5, 'top': 1}  # Adjust pos_hint as needed

            Separator:

            TwoPartLabel:
                id: username
                
            Separator:

            TwoPartLabel:
                id: title

            Separator:
                
            TwoPartLabel:
                id: checklist

            Separator:
            
            TwoPartLabel:
                id: image_path
            
            Separator:

            TwoPartLabel:
                id: location
            
            Separator:
                
            TwoPartLabel:
                id: details

            Separator:
                
            TwoPartLabel:
                id: urgency

            Separator:
            
            TwoPartLabel:
                id: status

            Separator:
            
            TwoPartLabel:
                id: dateCreated

            Separator:

<UserContent>:
    orientation: "vertical"
    size_hint_y: None
    height: "400dp"

    BoxLayout:
        size_hint_y: None
        height: self.minimum_height  # Adjust the height to fit the content
        
        MDLabel:
            text: "User Details"
            font_name: "BPoppins"
            font_size: "22sp"
            size_hint_y: None
            height: self.texture_size[1]

    ScrollView:
        size_hint_y: None
        height: 500  # Adjust based on your dialog box size

        GridLayout:
            cols: 1
            size_hint_y: None
            size_hint_x: 1  # Take full width of the ScrollView
            height: self.minimum_height
            spacing: "15dp"
            padding: [0, 20, 30, 30]  # Padding: [left, top, right, bottom]
            pos_hint: {'center_x': 0.5, 'top': 1}  # Adjust pos_hint as needed

            Separator:

            TwoPartLabel:
                id: username

            Separator:
                
            TwoPartLabel:
                id: email

            Separator:
            
            TwoPartLabel:
                id: birthdate
            
            Separator:
                
            TwoPartLabel:
                id: password

            Separator:
                
            TwoPartLabel:
                id: creditscore

            Separator:
            
            TwoPartLabel:
                id: type

            Separator:
            


                                
                    
MDScreen:
    name: "homescreen_admin"


    MDBoxLayout:
        orientation: "vertical"


        MDNavigationLayout:


            MDScreenManager:


                MDScreen:


                    BoxLayout:
                        orientation: 'vertical'


                        MDTopAppBar:
                            title: "[font=BPoppins][color=#3400E7][size=24]EyeWitness[/size][/color][/font]"
                            font_name: "BPoppins"
                            elevation: 0
                            pos_hint: {"top": 1}
                            md_bg_color: "white"
                            specific_text_color: "#000000"
                            left_action_items:
                                [['account-circle', lambda x: nav_drawer.set_state("open")]]
                            center_title: True
                       
                        MDBoxLayout:
                            orientation: 'vertical'


                            MDBottomNavigation:
                                elevation: 0
                                panel_color: "#3400E7"
                                selected_color_background: "#3400E7"
                                text_color_normal: 146/255, 193/255, 235/255, 1
                                text_color_active: 1, 1, 1, 2
                                font_name: "BPoppins"
                                font_size: "9sp"


                                MDBottomNavigationItem:
                                    name: "statistics"
                                    icon: "chart-line-variant"
                                    text: "Statistics"
                                    StatsLayout:


                                MDBottomNavigationItem:
                                    name: "users"
                                    icon: "account-supervisor-circle"
                                    text: "Users"


                                    UserAccounts:


                                MDBottomNavigationItem:
                                    name: "reports"
                                    icon: "file-eye"
                                    text: "View Reports"


                                    AllReportHistory:
                                        id: all_report_history
                                        user_id: 'some_user_id'  # Assign the user_id dynamically from your Python code

                                           
            MDNavigationDrawer:
                id: nav_drawer
                radius: (0, 16, 16, 0)
                width: "250dp"


                BoxLayout:
                    orientation: "vertical"
                    spacing: "12dp"


                    MDLabel:
                        id: currentUser
                        text: "Username" # Change it to the name of the current user
                        font_size: "18sp"
                        font_name: "BPoppins"
                        padding: "12dp", 0, 0, 0
                        size_hint_y: None
                        height: self.texture_size[1]


                    MDSeparator:
                        height: "1dp"
                        size_hint_y: None


                    MDRoundFlatIconButton:
                        text: "Log Out"
                        icon: "logout"
                        line_color: 1, 1, 1, 1
                        font_name: "MPoppins"
                        font_size: "16sp"
                        text_color: 0, 0, 0, 1
                        icon_color: 0, 0, 0, 1
                        padding: "12dp", 0, 0, 0
                        size_hint_y: None
                        focus_color: "#80B3FF"

                        # Create a logout function
                        on_release:
                            root.manager.transition = NoTransition()
                            root.manager.current = "main"


                    # Used to move the text up
                    ScrollView: